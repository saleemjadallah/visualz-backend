<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎯 AI Parametric Furniture System - 3D Viewer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            overflow: hidden;
        }
        
        .header {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px 20px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 1.2em;
            margin-bottom: 5px;
        }
        
        .header p {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        .controls {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            min-width: 250px;
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        .control-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9em;
        }
        
        .control-group select, .control-group button {
            width: 100%;
            padding: 8px;
            border: none;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 0.9em;
        }
        
        .control-group button {
            background: #4CAF50;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .control-group button:hover {
            background: #45a049;
        }
        
        .info-panel {
            position: absolute;
            bottom: 20px;
            left: 20px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            max-width: 400px;
        }
        
        .info-panel h3 {
            margin-bottom: 10px;
            color: #4CAF50;
        }
        
        .info-panel .detail {
            margin-bottom: 5px;
            font-size: 0.9em;
        }
        
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 100;
        }
        
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid #fff;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        #viewer {
            width: 100vw;
            height: 100vh;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
</head>
<body>
    <div class="header">
        <h1>🎯 AI Parametric Furniture System</h1>
        <p>Real-time 3D Visualization</p>
    </div>
    
    <div class="controls">
        <div class="control-group">
            <label>Cultural Style:</label>
            <select id="culture">
                <option value="french">🇫🇷 French Savoir-vivre</option>
                <option value="japanese">🇯🇵 Japanese Wabi-sabi</option>
                <option value="italian">🇮🇹 Italian Renaissance</option>
                <option value="scandinavian">🇸🇪 Scandinavian Hygge</option>
            </select>
        </div>
        
        <div class="control-group">
            <label>Furniture Type:</label>
            <select id="furnitureType">
                <option value="chair">🪑 Chair</option>
                <option value="dining-table">🍽️ Dining Table</option>
            </select>
        </div>
        
        <div class="control-group">
            <label>Material:</label>
            <select id="material">
                <option value="wood-cherry">🌸 Cherry Wood</option>
                <option value="wood-walnut">🌰 Walnut Wood</option>
                <option value="wood-oak">🌳 Oak Wood</option>
                <option value="wood-bamboo">🎋 Bamboo</option>
            </select>
        </div>
        
        <div class="control-group">
            <label>Craftsmanship:</label>
            <select id="craftsmanship">
                <option value="masterwork">✨ Masterwork</option>
                <option value="refined">⭐ Refined</option>
                <option value="simple">📐 Simple</option>
            </select>
        </div>
        
        <div class="control-group">
            <button onclick="generateFurniture()">🚀 Generate Furniture</button>
        </div>
    </div>
    
    <div class="info-panel" id="infoPanel" style="display: none;">
        <h3 id="furnitureName">Loading...</h3>
        <div class="detail">Cultural Authenticity: <span id="authenticity">0%</span></div>
        <div class="detail">Components: <span id="components">0</span></div>
        <div class="detail">Estimated Cost: $<span id="cost">0</span></div>
        <div class="detail">Generation Time: <span id="genTime">0ms</span></div>
        <div class="detail" id="culturalSignificance" style="margin-top: 10px; font-style: italic;"></div>
    </div>
    
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <p>Generating parametric furniture...</p>
    </div>
    
    <div id="viewer"></div>
    
    <script>
        // Three.js setup
        let scene, camera, renderer, controls;
        let currentFurniture = null;
        
        function init() {
            // Scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x1a1a2e);
            
            // Camera
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(2, 2, 2);
            
            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            document.getElementById('viewer').appendChild(renderer.domElement);
            
            // Controls
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            
            // Lighting
            const ambientLight = new THREE.AmbientLight(0x404040, 0.4);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(10, 10, 5);
            directionalLight.castShadow = true;
            directionalLight.shadow.mapSize.width = 2048;
            directionalLight.shadow.mapSize.height = 2048;
            scene.add(directionalLight);
            
            // Floor
            const floorGeometry = new THREE.PlaneGeometry(10, 10);
            const floorMaterial = new THREE.MeshLambertMaterial({ 
                color: 0x444444,
                transparent: true,
                opacity: 0.3
            });
            const floor = new THREE.Mesh(floorGeometry, floorMaterial);
            floor.rotation.x = -Math.PI / 2;
            floor.receiveShadow = true;
            scene.add(floor);
            
            // Initial generation
            generateFurniture();
            
            animate();
        }
        
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        
        function generateFurniture() {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('infoPanel').style.display = 'none';
            
            // Remove existing furniture
            if (currentFurniture) {
                scene.remove(currentFurniture);
            }
            
            // Get parameters
            const culture = document.getElementById('culture').value;
            const furnitureType = document.getElementById('furnitureType').value;
            const material = document.getElementById('material').value;
            const craftsmanship = document.getElementById('craftsmanship').value;
            
            // Simulate generation delay
            setTimeout(() => {
                const startTime = Date.now();
                
                // Create furniture based on parameters
                currentFurniture = createParametricFurniture({
                    culture,
                    furnitureType,
                    material,
                    craftsmanship
                });
                
                scene.add(currentFurniture);
                
                // Update info panel
                const genTime = Date.now() - startTime;
                updateInfoPanel(culture, furnitureType, material, craftsmanship, genTime);
                
                document.getElementById('loading').style.display = 'none';
                document.getElementById('infoPanel').style.display = 'block';
                
            }, 1200); // Simulate AI processing time
        }
        
        function createParametricFurniture(params) {
            const furniture = new THREE.Group();
            
            // Material colors based on type
            const materialColors = {
                'wood-cherry': 0x8B4513,
                'wood-walnut': 0x654321,
                'wood-oak': 0xD2B48C,
                'wood-bamboo': 0xDAA520
            };
            
            const materialColor = materialColors[params.material] || 0x8B4513;
            
            // Cultural proportions
            const culturalProps = getCulturalProportions(params.culture);
            
            if (params.furnitureType === 'chair') {
                // Seat
                const seatGeometry = new THREE.BoxGeometry(0.5, 0.05, 0.5);
                const seatMaterial = new THREE.MeshLambertMaterial({ color: materialColor });
                const seat = new THREE.Mesh(seatGeometry, seatMaterial);
                seat.position.y = culturalProps.seatHeight;
                seat.castShadow = true;
                furniture.add(seat);
                
                // Backrest
                const backGeometry = new THREE.BoxGeometry(0.45, 0.4, 0.03);
                const backMaterial = new THREE.MeshLambertMaterial({ color: materialColor });
                const backrest = new THREE.Mesh(backGeometry, backMaterial);
                backrest.position.y = culturalProps.seatHeight + 0.2;
                backrest.position.z = -0.235;
                backrest.rotation.x = THREE.MathUtils.degToRad(-culturalProps.backrestAngle);
                backrest.castShadow = true;
                furniture.add(backrest);
                
                // Legs
                const legPositions = [
                    { x: -0.2, z: -0.2 },
                    { x: 0.2, z: -0.2 },
                    { x: -0.2, z: 0.2 },
                    { x: 0.2, z: 0.2 }
                ];
                
                legPositions.forEach(pos => {
                    const legGeometry = getCulturalLegGeometry(params.culture, culturalProps);
                    const legMaterial = new THREE.MeshLambertMaterial({ color: materialColor * 0.8 });
                    const leg = new THREE.Mesh(legGeometry, legMaterial);
                    leg.position.set(pos.x, culturalProps.seatHeight / 2, pos.z);
                    leg.castShadow = true;
                    furniture.add(leg);
                });
                
                // Cultural details
                if (params.culture === 'french' && params.craftsmanship === 'masterwork') {
                    addFrenchDetails(furniture, culturalProps);
                }
                
            } else if (params.furnitureType === 'dining-table') {
                // Table top
                const topGeometry = new THREE.BoxGeometry(2.0, 0.04, 1.0);
                const topMaterial = new THREE.MeshLambertMaterial({ color: materialColor });
                const top = new THREE.Mesh(topGeometry, topMaterial);
                top.position.y = culturalProps.tableHeight;
                top.castShadow = true;
                furniture.add(top);
                
                // Table legs
                const legPositions = [
                    { x: -0.85, z: -0.35 },
                    { x: 0.85, z: -0.35 },
                    { x: -0.85, z: 0.35 },
                    { x: 0.85, z: 0.35 }
                ];
                
                legPositions.forEach(pos => {
                    const legGeometry = new THREE.BoxGeometry(0.08, culturalProps.tableHeight, 0.08);
                    const legMaterial = new THREE.MeshLambertMaterial({ color: materialColor * 0.9 });
                    const leg = new THREE.Mesh(legGeometry, legMaterial);
                    leg.position.set(pos.x, culturalProps.tableHeight / 2, pos.z);
                    leg.castShadow = true;
                    furniture.add(leg);
                });
            }
            
            return furniture;
        }
        
        function getCulturalProportions(culture) {
            const props = {
                'french': { seatHeight: 0.45, tableHeight: 0.75, backrestAngle: 18 },
                'japanese': { seatHeight: 0.35, tableHeight: 0.68, backrestAngle: 15 },
                'italian': { seatHeight: 0.46, tableHeight: 0.76, backrestAngle: 18 },
                'scandinavian': { seatHeight: 0.43, tableHeight: 0.73, backrestAngle: 20 }
            };
            return props[culture] || props['french'];
        }
        
        function getCulturalLegGeometry(culture, props) {
            if (culture === 'french') {
                // Cabriole leg style
                return new THREE.CylinderGeometry(0.025, 0.02, props.seatHeight, 12);
            } else if (culture === 'japanese') {
                // Tapered leg
                return new THREE.CylinderGeometry(0.015, 0.025, props.seatHeight, 8);
            } else if (culture === 'scandinavian') {
                // Simple cylindrical
                return new THREE.CylinderGeometry(0.02, 0.02, props.seatHeight, 8);
            } else {
                // Box leg
                return new THREE.BoxGeometry(0.04, props.seatHeight, 0.04);
            }
        }
        
        function addFrenchDetails(furniture, props) {
            // Add decorative elements for French masterwork
            const ornamentGeometry = new THREE.SphereGeometry(0.015, 8, 8);
            const ornamentMaterial = new THREE.MeshLambertMaterial({ color: 0xDAA520 });
            const ornament = new THREE.Mesh(ornamentGeometry, ornamentMaterial);
            ornament.position.set(0, props.seatHeight + 0.35, -0.22);
            furniture.add(ornament);
        }
        
        function updateInfoPanel(culture, furnitureType, material, craftsmanship, genTime) {
            const culturalNames = {
                'french': 'French Savoir-vivre',
                'japanese': 'Japanese Wabi-sabi', 
                'italian': 'Italian Renaissance',
                'scandinavian': 'Scandinavian Hygge'
            };
            
            const furnitureNames = {
                'chair': 'Chair',
                'dining-table': 'Dining Table'
            };
            
            const costs = {
                'chair': { 'simple': 300, 'refined': 450, 'masterwork': 750 },
                'dining-table': { 'simple': 800, 'refined': 1200, 'masterwork': 2000 }
            };
            
            const materialMultipliers = {
                'wood-cherry': 1.5,
                'wood-walnut': 1.8,
                'wood-oak': 1.2,
                'wood-bamboo': 1.1
            };
            
            const significance = {
                'french': 'Embodies French savoir-vivre and the art of elegant conversation',
                'japanese': 'Represents harmony with nature and mindful living',
                'italian': 'Reflects Renaissance ideals of beauty and craftsmanship', 
                'scandinavian': 'Embodies hygge philosophy of comfort and well-being'
            };
            
            const baseCost = costs[furnitureType][craftsmanship];
            const finalCost = Math.round(baseCost * materialMultipliers[material]);
            
            document.getElementById('furnitureName').textContent = 
                `${culturalNames[culture]} ${furnitureNames[furnitureType]}`;
            document.getElementById('authenticity').textContent = '95%';
            document.getElementById('components').textContent = 
                furnitureType === 'chair' ? '6' : '5';
            document.getElementById('cost').textContent = finalCost;
            document.getElementById('genTime').textContent = genTime;
            document.getElementById('culturalSignificance').textContent = significance[culture];
        }
        
        // Handle window resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
        
        // Initialize when page loads
        window.addEventListener('load', init);
    </script>
</body>
</html>